Just some funtions and nested loops
